\dt
CREATE TABLE Ciudades(cid INT, nombre VARCHAR(255), PRIMARY KEY(cid)) ;
\dt
\COPY ciudades from './Entrega2/datos/Ciudades.csv' DELIMETER ',' CSV HEADER
\COPY ciudades from './Entrega2/datos/Ciudades.csv' DELIMITER ',' CSV HEADER
\COPY ciudades from './Entrega2/datos/Ciudades.csv' DELIMETER ',' CSV HEADER ENCODING 'latin1'
\COPY ciudades from './Entrega2/datos/Ciudades.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
SELECT * FROM ciudades
\dt
\q
\dt
\d
\d ciudades
SELECT * FROM ciudades ;
CREATE TABLE usuarios(uid INT, username VARCHAR(255), PRIMARY KEY(uid)) ;
\COPY usuarios from './Entrega2/datos/Usuarios.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
CREATE TABLE mail_usuarios(muid INT, mail VARCHAR(255), PRIMARY KEY(muid)) ;
\COPY mail_usuarios from './Entrega2/datos/Mail_Usuarios.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\COPY mail_usuarios from './Entrega2/datos/Mail_Usuarios.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\COPY mail_usuaruios from './Entrega2/datos/Mail_usuarios.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\COPY mail_usuarios from './Entrega2/datos/Mail_usuarios.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
CREATE TABLE tiene_datos(duid INT, uid INT, PRIMARY KEY(duid), FOREIGN KEY(uid) REFERENCES usuarios(uid)) ;
\COPY tiene_datos from './Entrega2/datos/Tiene_datos.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
CREATE TABLE datos_usuarios(duid INT, nombre VARCHAR(255), direccionusuario VARCHAR(255), PRIMARY KEY(duid)) ;
\COPY datos_usuarios from './Entrega2/datos/Datos_usuarios.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
CREATE TABLE tiene_mail(muid INT, uid INT, PRIMARY KEY(muid), FOREIGN KEY(uid) REFERENCES usuarios(uid)) ;
\COPY tiene_mail from './Entrega2/datos/Tiene_mail.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
CREATE TABLE paises(pid INT, nombre VARCHAR(255), PRIMARY KEY(pid)) ;
\COPY paises from './Entrega2/datos/Paises.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
CREATE TABLE pertenece_a(cid INT, pid INT, PRIMARY KEY(cid), FOREIGN KEY(pid) REFERENCES paises(pid)) :CREATE TABLE pertenece_a(cid INT, pid INT, PRIMARY KEY(cid), FOREIGN KEY(pid) REFERENCES paises(pid)) ;
CREATE TABLE pertenece_a(cid INT, pid INT, PRIMARY KEY(cid), FOREIGN KEY(pid) REFERENCES paises(pid)) ;
\COPY pertenece_a from './Entrega2/datos/Pertenece_a.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
SELECT * FROM pertenece_a ;
CREATE TABLE contactos_paises(cpid INT, contacto VARCHAR(255), PRIMARY KEY(cpid))CREATE TABLE contactos_paises(cpid INT, contacto VARCHAR(255), PRIMARY KEY(cpid)) ;
CREATE TABLE contactos_paises(cpid INT, contacto VARCHAR(255), PRIMARY KEY(cpid)) ;
\COPY contactos_paises from './Entrega2/datos/Contactos_paises.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\dt
\q
\dt
CREATE TABLE tiene_contacto(pid INT, cpid INT, PRIMARY KEY cpid, FOREIGN KEY pid REFERENCES paises(pid)
\dt
\q
CREATE TABLE tiene_contacto(pid INT, cpid INT, PRIMARY KEY cpid, FOREIGN KEY pid REFERENCES paises(pid)) ;
CREATE TABLE tiene_contacto(pid INT, cpid INT, PRIMARY KEY(cpid), FOREIGN KEY(pid) REFERENCES paises(pid)) ;
÷dt
\dt
SELECT * FROM tiene_contacto ;
SELECT * FROM tiene_contacto ;
\COPY tiene_contacto from './Entrega2/datos/tiene_contacto.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\COPY tiene_contacto from './Entrega2/datos/Tiene_contacto.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
\q
\dt
CREATE TABLE viajes(vid INT, horasalida TIME, duracion INT, transporte VARCHAR(255), capacidad INT, precio INT, PRIMARY KEY(vid)) ;
\COPY viajes from ‘./Entrega2/datos/Viajes.csv’ DELIMITER ‘,’ CSV HEADER ENCODING ‘latin1’ 
\COPY viajes from ‘./Entrega2/datos/Viajes.csv’ DELIMITER ‘,’ CSV HEADER ENCODING ‘latin1’ 
\q
\COPY viajes from ‘./Entrega2/datos/Viajes.csv’ DELIMITER ‘,’ CSV HEADER ENCODING ‘latin1’ 
\dt
\COPY viajes from './Entrega2/datos/Viajes.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1'
CREATE TABLE origen(vid INT, cid INT, PRIMARY KEY(vid), FOREIGN KEY(cid) REFERENCES ciudades(cid)) ;
\COPY origen from './Entrega2/datos/Origen.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE destino(vid INT, cid INT, PRIMARY KEY(vid), FOREIGN KEY(cid) REFERENCES ciudades(cid)) ;
\COPY destino from './Entrega2/datos/Destino.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE origen(tid INT, asiento INT, fechaviaje DATE, PRIMARY KEY(tid)) ;
CREATE TABLE tickets(tid INT, asiento INT, fechaviaje DATE, PRIMARY KEY(tid)) ;
\COPY tickets from './Entrega2/datos/Tickets.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE para(tid INT, vid INT, PRIMARY KEY(tid), FOREIGN KEY(vid) REFERENCES viajes(vid)) ;
\COPY para from './Entrega2/datos/Para.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE hoteles(hid INT, nombre VARCHAR(255), direccionhotel VARCHAR(255), telefono VARCHAR(255), precionoche INT,  PRIMARY KEY(hid)) ;
\COPY hoteles from './Entrega2/datos/Hoteles.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE esta_en(hid INT, cid INT, PRIMARY KEY(hid), FOREIGN KEY(cid) REFERENCES ciudades(cid)) ;
\COPY esta_en from './Entrega2/datos/Esta_en.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE reservas(rid INT, checkin DATE, chekout DATE, PRIMARY KEY(rid));
\COPY reservas from './Entrega2/datos/Reservas.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE hace(uid INT, rid INT, PRIMARY KEY(rid), FOREIGN KEY(uid) REFERENCES usuarios(uid)) ;
\COPY hace from './Entrega2/datos/Hace.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE en_hotel(rid INT, hid INT, PRIMARY KEY(rid), FOREIGN KEY(hid) REFERENCES hoteles(hid)) ;
\COPY en_hotel from './Entrega2/datos/En_hotel.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
\DT
\dt
SELECT * from en_hotel ;
\q
\dt
\q
\dt
\COPY esta_en from './Entrega2/datos/Esta_en.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
CREATE TABLE compra_ticket(tid INT, uid INT, fechacompra DATE, PRIMARY KEY(tid), FOREIGN KEY(uid) REFERENCES usuarios(uid)) ;
\COPY compra_ticket from './Entrega2/datos/Compra_ticket.csv' DELIMITER ',' CSV HEADER ENCODING 'latin1' 
\dt
\q
SELECT izquierda.uid, SUM(derecha.precio) FROM (SELECT uid, tid FROM usuarios, compra, tickets WHERE usuarios.uid = compra.uid AND compra.tid = tickets.tid) AS izquierda, (SELECT viajes.precio, tickets.tid FROM viajes, para, tickets WHERE viajes.vid = para.vid AND para.tid = tickets.tid) AS derecha WHERE izquierda.tid = derecha.tid AND izquierda.uid = $uid GROUP BY izquierda.uid;
SELECT izquierda.uid, SUM(derecha.precio) FROM (SELECT uid, tid FROM usuarios, compra, tickets WHERE usuarios.uid = compra.uid AND compra.tid = tickets.tid) AS izquierda, (SELECT viajes.precio, tickets.tid FROM viajes, para, tickets WHERE viajes.vid = para.vid AND para.tid = tickets.tid) AS derecha WHERE izquierda.tid = derecha.tid AND izquierda.uid = 1 GROUP BY izquierda.uid;
SELECT izquierda.uid, SUM(derecha.precio) FROM (SELECT uid, tid FROM usuarios, compra, tickets WHERE usuarios.uid = compra_ticket.uid AND compra.tid = tickets.tid) AS izquierda, (SELECT viajes.precio, tickets.tid FROM viajes, para, tickets WHERE viajes.vid = para.vid AND para.tid = tickets.tid) AS derecha WHERE izquierda.tid = derecha.tid AND izquierda.uid = 1 GROUP BY izquierda.uid;
SELECT izquierda.uid, SUM(derecha.precio) FROM (SELECT uid, tid FROM usuarios, compra_ticket, tickets WHERE usuarios.uid = compra_ticket.uid AND compra_ticket.tid = tickets.tid) AS izquierda, (SELECT viajes.precio, tickets.tid FROM viajes, para, tickets WHERE viajes.vid = para.vid AND para.tid = tickets.tid) AS derecha WHERE izquierda.tid = derecha.tid AND izquierda.uid = 1 GROUP BY izquierda.uid;
SELECT izquierda.uid, SUM(derecha.precio) FROM (SELECT usuarios.uid, tickets.tid FROM usuarios, compra_ticket, tickets WHERE usuarios.uid = compra_ticket.uid AND compra_ticket.tid = tickets.tid) AS izquierda, (SELECT viajes.precio, tickets.tid FROM viajes, para, tickets WHERE viajes.vid = para.vid AND para.tid = tickets.tid) AS derecha WHERE izquierda.tid = derecha.tid AND izquierda.uid = 1 GROUP BY izquierda.uid;
SELECT izquierda.uid, SUM(derecha.precio) FROM (SELECT usuarios.uid, tickets.tid FROM usuarios, compra_ticket, tickets WHERE usuarios.uid = compra_ticket.uid AND compra_ticket.tid = tickets.tid) AS izquierda, (SELECT viajes.precio, tickets.tid FROM viajes, para, tickets WHERE viajes.vid = para.vid AND para.tid = tickets.tid) AS derecha WHERE izquierda.tid = derecha.tid AND izquierda.uid = 2 GROUP BY izquierda.uid;
SELECT arriba.uid,arriba.nombre,arriba.checkin,arriba.checkout, abajo.nombre FROM (SELECT hoteles.nombre, reservas.rid FROM hoteles, en_hotel, reservas WHERE hoteles.hid = en_hotel.hid AND en_hotel.rid = reservas.rid) AS abajo, (SELECT usuarios.uid, datos_usuarios.nombre, reservas.checkin, reservas.checkout, reservas.rid FROM datos_usuarios, tiene_datos, usuarios, hace, reservas WHERE datos_usuarios.duid = tiene_datos.duid AND tiene_datos.uid = usuarios.uid AND hace.uid = usuarios.uid AND hace.rid = reservas.rid AND reservas.checkin >= ‘2020-01-01’ AND reservas.checkout <= ‘2020-03-31’) AS arriba WHERE arriba.rid = abajo.rid;
SELECT arriba.uid,arriba.nombre,arriba.checkin,arriba.checkout, abajo.nombre FROM (SELECT hoteles.nombre, reservas.rid FROM hoteles, en_hotel, reservas WHERE hoteles.hid = en_hotel.hid AND en_hotel.rid = reservas.rid) AS abajo, (SELECT usuarios.uid, datos_usuarios.nombre, reservas.checkin, reservas.checkout, reservas.rid FROM datos_usuarios, tiene_datos, usuarios, hace, reservas WHERE datos_usuarios.duid = tiene_datos.duid AND tiene_datos.uid = usuarios.uid AND hace.uid = usuarios.uid AND hace.rid = reservas.rid AND reservas.checkin >= '2020-01-01' AND reservas.checkout <= '2020-03-31') AS arriba WHERE arriba.rid = abajo.rid;
select * from reservas;
SELECT arriba.uid,arriba.nombre,arriba.checkin,arriba.chekout, abajo.nombre FROM (SELECT hoteles.nombre, reservas.rid FROM hoteles, en_hotel, reservas WHERE hoteles.hid = en_hotel.hid AND en_hotel.rid = reservas.rid) AS abajo, (SELECT usuarios.uid, datos_usuarios.nombre, reservas.checkin, reservas.chekout, reservas.rid FROM datos_usuarios, tiene_datos, usuarios, hace, reservas WHERE datos_usuarios.duid = tiene_datos.duid AND tiene_datos.uid = usuarios.uid AND hace.uid = usuarios.uid AND hace.rid = reservas.rid AND reservas.checkin >= '2020-01-01' AND reservas.chekout <= '2020-03-31') AS arriba WHERE arriba.rid = abajo.rid;
\q
